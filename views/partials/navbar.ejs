<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Al's Windows</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* Global navbar positioning */
    nav.site-navbar { position: fixed; top: 0; width: 100%; height: 80px; z-index: 1000; }
    body { margin: 0; padding-top: 80px; } /* match nav height */

    /* Logo */
    .site-navbar .navbar-brand img {
      height: 60px; width: auto; border-radius: 0; object-fit: contain;
    }

    /* Buttons */
    .site-navbar .quote-btn2,
    .site-navbar .btn-logout {
      padding: 8px 20px; font-size: 1rem; font-weight: 600; border-radius: 8px;
      background-color: #0047AB; color: #fff; transition: .3s; text-decoration: none;
      box-shadow: 0 4px 12px rgba(0,0,0,.4); border: none;
    }
    .site-navbar .quote-btn2:hover,
    .site-navbar .btn-logout:hover {
      background-color: #003b93; transform: scale(1.05);
    }

    /* Mobile-only tweaks */
    @media (max-width: 991.98px){
      .site-navbar .navbar-brand img { height: 40px; }
      .site-navbar .container { position: relative; gap: .5rem; }
      .site-navbar .navbar-toggler { padding: .25rem .5rem; margin-left: .25rem; border-color: rgba(255,255,255,.4); }

      .site-navbar .navbar-collapse{
        position: absolute; top: 80px; right: 0; width: 250px;
        background-color: #052e6c; padding: 1rem; border-radius: 0 0 0 8px;
        box-shadow: -2px 4px 8px rgba(0,0,0,.25); z-index: 1200;
      }
      .site-navbar .navbar-collapse .nav-link{
        display: block; margin-bottom: .75rem; color: #fff !important; font-size: 1.1rem;
      }

      .site-navbar .quote-btn2.d-lg-none,
      .site-navbar .btn-logout.d-lg-none{
        padding: 6px 12px; font-size: .95rem;
      }
    }
  </style>
</head>

<body>
  <% if (security) { %>
  <!-- Employee Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark site-navbar" style="background-color:#052e6c;">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="/">
        <img src="/images/whiteLogo.png" alt="Al's Windows logo" class="me-2">
      </a>

      <!-- MOBILE: Logout -->
      <button class="btn-logout d-lg-none ms-auto me-2" id="navbarLogoutBtnSm" type="button">Logout</button>

      <!-- Hamburger -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavEmp"
              aria-controls="navbarNavEmp" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapse -->
      <div class="collapse navbar-collapse" id="navbarNavEmp">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link <%= (navPage === 'customers') ? 'active' : '' %>" href="/customerManagement">Customers</a></li>
          <li class="nav-item"><a class="nav-link <%= (navPage === 'leads') ? 'active' : '' %>" href="/leadManagement">Leads</a></li>
        </ul>
        <!-- DESKTOP: Logout -->
        <button type="button" class="btn-logout ms-3 d-none d-lg-inline-block" onclick="window.location.href='/logout'">Logout</button>
      </div>
    </div>
  </nav>

  <% } else { %>
  <!-- Public Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark site-navbar" style="background-color:#052e6c;">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="/">
        <img src="/images/whiteLogo.png" alt="Al's Windows logo" class="me-2">
      </a>

      <!-- MOBILE: Quote -->
      <button class="quote-btn2 d-lg-none ms-auto me-2" id="navbarQuoteBtnSm" type="button">Get a Quote</button>

      <!-- Hamburger -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavPub"
              aria-controls="navbarNavPub" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapse -->
      <div class="collapse navbar-collapse" id="navbarNavPub">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link <%= (navPage === 'about') ? 'active' : '' %>" href="/aboutUs">About Us</a></li>
          <li class="nav-item"><a class="nav-link <%= (navPage === 'calculator') ? 'active' : '' %>" href="/calculator">Quote Calculator</a></li>
        </ul>
        <!-- DESKTOP: Quote -->
        <a class="btn-quote ms-3 d-none d-lg-inline-block" id="navbarQuoteBtn">Get a Quote</a>
      </div>
    </div>
  </nav>
  <% } %>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const quoteFormWrapper = document.getElementById('quoteFormWrapper');
      const closeForm       = document.getElementById('closeForm');
      const btnDesktop      = document.getElementById('navbarQuoteBtn');
      const btnMobile       = document.getElementById('navbarQuoteBtnSm');
      const btnLogoutMobile = document.getElementById('navbarLogoutBtnSm');

      const openQuote = () => quoteFormWrapper?.classList.add('active');

      btnDesktop?.addEventListener('click', openQuote);
      btnMobile?.addEventListener('click', openQuote);
      btnLogoutMobile?.addEventListener('click', () => { window.location.href = '/logout'; });

      closeForm?.addEventListener('click', () => quoteFormWrapper?.classList.remove('active'));
    });
  </script>
</body>
</html>
